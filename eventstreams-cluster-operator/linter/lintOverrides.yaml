overrides:
  # -------------------------------------------------------------------
  # overrides - rules we need to override
  # ----------------------------

  # TODO ensure deployment for release has a locked down version
  - rule: "NoLatestImageTags"
    message: '^\[ERROR\] scanned-deployment-\w+-eventstreams-operator\.yaml:.*'
    reason: "Set to latest for development purposes"
  - rule: "LatestTagHasPullPolicyAlways"
    message: '^\[ERROR\] scanned-deployment-\w+-eventstreams-operator\.yaml:.*'
    reason: "Set to latest for development purposes"
  # TODO lock down versions
  - rule: "NoLatestImageTags"
    message: '^\[ERROR\] scanned-deployment-\w+-(my-es-entity|strimzi-cluster)-operator\.yaml:.*'
    reason: "Set to latest for development purposes"

  # TODO validate if this is true and if so for how long.
  - rule: "NoAlphaAnnotations"
    message: '^\[ERROR\] scanned-service-\w+-my-es-(kafka-brokers|zookeeper-nodes)\.yaml:.*'
    reason: "Back-level versions of kubernetes need supporting by Strimzi"

  - rule: "PodHasArchBasedNodeAffinity"
    reason: "Implementing fat manifests, this no longer applies"

  - rule: "RequiredMetadataLabelsDefined"
    message: '^\[ERROR\] scanned-eventstreams-\w+-my-es\.yaml:.*'
    reason: "User configured CR does not require labels"

  - rule: "RequiredMetadataLabelsDefined"
    message: '^\[ERROR\] scanned-kafkatopic-\w+-.*'
    reason: "KafkaTopics autogenerated on startup, we do not control the labels and they can be considered a user configured CR"

  - rule: "RequiredMetadataLabelsDefined"
    message: '^\[ERROR\] scanned-secret-\w+-my-es-ibm-es-oidc-secret\.yaml:.*'
    reason: "The OIDC secret, created and managed by the OIDC operator does not have any way to configure labels"

  - rule: "RequiredMetadataLabelsDefined"
    message: '^\[ERROR\] scanned-secret-\w+-my-es-ibm-es-ui-service-cert\.yaml:.*'
    reason: "THe service cert is generated by openshift, its labels cannot be configured by us"

  - rule: "RequiredMetadataLabelsDefined"
    message: '^\[ERROR\] scanned-secret-\w+-ibm-entitlement-key\.yaml:.*'
    reason: "User Image Pull Secret does not require labels"

##############################
# CUSTOM STRIMZI REQUIRED
##############################

  # TODO: Custom Strimzi with PodSecurityContextDefined
  - rule: "PodSecurityContextDefined"
    message: '^\[ERROR\] scanned-(deployment|statefulset)-\w+-my-es-(kafka|zookeeper|entity-operator)\.yaml:.*'
    reason: "Look into this"
  - rule: "PodSecurityContextDefined"
    message: '^\[ERROR\] scanned-deployment-\w+-my-es-ibm-es-replicator-connect\.yaml:.*'
    reason: "Look into this"

##############################
# CLOUDPAK CLARIFICATION REQUIRED
##############################

##############################
# CV LINTER BUGS
##############################

  # TODO report namespace default resources being picked up by scan to linter team
  - rule: "RequiredMetadataLabelsDefined"
    message: '^\[ERROR\] scanned-rolebinding-\w+-system:[a-zA-Z-]+\.yaml:.*'
    reason: "These files are OpenShift default files and shouldn't be scanned"
  - rule: "ResourceNameIsValid"
    message: '^\[ERROR\] scanned-rolebinding-\w+-system:[a-zA-Z-]+\.yaml:.*'
    reason: "These files are OpenShift default files and shouldn't be scanned"
  - rule: "RequiredMetadataLabelsDefined"
    message: '^\[ERROR\] scanned-(rolebinding|serviceaccount)-\w+-(admin|builder|default|deployer)\.yaml:.*'
    reason: "These are default resources and should not be scanned"

  # TODO report that imagestream does not need to be picked up and scanned
  - rule: "RequiredMetadataLabelsDefined"
    message: '^\[ERROR\] scanned-(imagestream|imagestreamtag)-[a-zA-Z0-9-:\.]+\.yaml:.*'
    reason: "These are generated resources and should not be scanned"
  - rule: "ResourceNameIsValid"
    message: '^\[ERROR\] scanned-imagestreamtag-[a-zA-Z0-9-:\.]+\.yaml:.*'
    reason: "These are generated resources and should not be scanned"

##############################
# TO FIX
##############################

  - rule: "RequiredMetadataLabelsDefined"
    message: '^\[ERROR\] scanned-serviceaccount-\w+-(eventstreams|strimzi)-cluster-operator\.yaml:.*'
    reason: "Operator SAs"

  - rule: "RequiredMetadataLabelsDefined"
    message: '^\[ERROR\] scanned-rolebinding-\w+-(eventstreams|strimzi)-cluster-operator(|-topic-operator-delegation|-user-operator-delegation|-entity-operator-delegation)\.yaml:.*'
    reason: "Operator Rolebindings"

  - rule: "RequiredMetadataLabelsDefined"
    message: '^\[ERROR\] scanned-deployment-\w+-eventstreams-cluster-operator\.yaml:.*'
    reason: "Operator Deployment"

  - rule: "ContainerDefinesResources"
    message: '^\[ERROR\] scanned-deployment-\w+-eventstreams-cluster-operator\.yaml:.*'
    reason: "Operator Deployment"